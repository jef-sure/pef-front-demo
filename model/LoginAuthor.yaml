---
params:
  ip: $ip
  login:
      base: limit40str
      min-size: 1
  password: $limit4_40str
model: Author::login
result:
  OK:
    redirect:
      - TT form.back_url
      - /
    set-cookie:
      auth:
        value: TT response.auth
        expires: TT response.expires
  DEFAULT:
    redirect: TT "/appLogin?message=${response.answer}" ~ (form.back_url? "&back_url=${form.back_url}":"")
    unset-cookie: auth
expected:
  - result: OK
    expires:
    auth:
  - result: PASSWORD
    answer:
  - result: $DEFAULT
    